syntax = "proto3";
option java_multiple_files = true;
option java_package = "CnText";

package CnText;

service CnText {
    rpc start (Login) returns (Session);
    rpc close (Session) returns (CloseResponse);
    rpc upload (UploadRequest) returns (UploadRequestResponse);
//    rpc consult (UploadRequestResponse) returns (stream UploadStatus);
    rpc translate (TranslateRequest) returns (TranslateResponse);
}

enum LoginStatus {
    SUCCESS = 0;
    UNKNOWN_USER = 1;
    WRONG_PASSWORD = 2;
    COMMUNICATION_ERROR = 3;
}

message Login {
    string user = 1;
    string password = 2;
}

message Session {
    string sessionId = 1;
    string user = 2;
    LoginStatus status = 3;
}

message CloseResponse {
    string response = 1;
}

message UploadRequest {
    bytes image = 1;
    string sessionId = 2;
}

message UploadRequestResponse {
    string uploadToken = 1;
    string status = 2;
}

//message UploadStatus {
//    string status = 1;
//}

message TranslateRequest {
    string uploadToken = 1;
    string language = 2;
    string sessionId = 3;
}

message TranslateResponse {
    string translation = 1;
    string status = 2;
}